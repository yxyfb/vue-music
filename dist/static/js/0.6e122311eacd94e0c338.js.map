{"version":3,"sources":["webpack:///src/common/detail/detail.vue","webpack:///./src/common/detail/detail.vue?8d82","webpack:///./src/common/detail/detail.vue"],"names":["transform","Object","dom","detail","mixins","mixin","data","scrollY","mounted","this","headerH","parseFloat","document","documentElement","style","fontSize","$refs","scroll","$el","top","bgImage","clientHeight","MaxLayerHeight","props","type","String","default","title","songs","Array","iconShow","Boolean","methods","extends_default","back","$router","pos","y","playMusic","song","index","selectMusic","list","changeListBottom","playList","bottom","length","refresh","randomPlay","randomPlayAll","vuex_esm","watch","newY","maxLayerH","Math","max","layer","paddingTop","height","zIndex","playBtn","display","scaleNum","abs","computed","bgImg","components","v-songList","songList","v-scroll","scroll_scroll","v-loading","loading","detail_detail","render","_vm","_h","$createElement","_c","_self","staticClass","on","click","_v","_s","ref","attrs","listenScroll","probeType","directives","name","rawName","value","expression","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/0.6e122311eacd94e0c338.js","sourcesContent":["<template>\r\n    <div class=\"detail\">\r\n        <div class=\"detail-header\">\r\n            <i class=\"iconfont icon-back\" @click='back'></i>\r\n            <h1 class=\"detail-title\">{{title}}</h1>\r\n        </div>\r\n        <div class=\"detail-bgImg\" :style='bgImg' ref='bgImage'>\r\n            <div class=\"filter\"></div>\r\n            <div class=\"play-wrapper\" ref='playBtn'>\r\n                <div class=\"play\" @click='randomPlay'>\r\n                    <i class=\"iconfont icon-play\"></i>\r\n                    <span class=\"play-text\">随机播放全部</span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"layer\" ref='layer'></div>\r\n\r\n        <v-scroll class=\"songList-wrapper\"\r\n                  :data='songs'\r\n                  :listenScroll='true'\r\n                  :probeType='3'\r\n                  @scroll=\"scroll\"\r\n                  ref='scroll'>\r\n            <v-songList :songs='songs' @playMusic='playMusic' :iconShow='iconShow'></v-songList>\r\n        </v-scroll>\r\n        <div class=\"loading-wrapper\" v-show='!songs.length'>\r\n            <v-loading></v-loading>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n//主要原理，根据图片高度动态设置scroll距离顶部的高度\r\n\r\nimport SongList from 'common/songList/songList'\r\nimport Scroll from 'common/scroll/scroll'\r\nimport Loading from 'common/loading/loading'\r\nimport {prefixStyle} from 'js/dom'\r\nimport {mapActions,mapMutations} from 'vuex'\r\nimport {playListMixin} from 'js/mixin'\r\n\r\nconst transform = prefixStyle('transform');//兼容性\r\n\r\nexport default {\r\n    mixins:[playListMixin],\r\n    data() {\r\n        return {\r\n            scrollY: 0 \r\n        }\r\n    },\r\n    mounted() {\r\n        this.headerH = 0.88 * parseFloat(document.documentElement.style.fontSize);\r\n        this.$refs.scroll.$el.style.top = this.$refs.bgImage.clientHeight+'px';\r\n        this.MaxLayerHeight = -1*(this.$refs.bgImage.clientHeight - this.headerH);  //遮罩层滚动的最大距离\r\n    },\r\n    props: {\r\n        bgImage: {\r\n            type: String,\r\n            default:''\r\n        },\r\n        title: {\r\n            type: String,\r\n            default: ''\r\n        },\r\n        songs: {\r\n            type: Array,\r\n            default:() => []\r\n        },\r\n        iconShow: {\r\n            type: Boolean,\r\n            default: false\r\n        }\r\n    },\r\n    methods: {\r\n        back() {\r\n            this.$router.back();\r\n        },\r\n        scroll(pos) { //scroll组件触发的事件，获取滚动高度\r\n            this.scrollY = pos.y;\r\n        },\r\n        playMusic(song,index) {\r\n            this.selectMusic({ //vuex中acrions,一次提交多个数据\r\n                list: this.songs,  //歌曲列表\r\n                index: index       //正在播放歌曲下标\r\n            })\r\n        },\r\n        changeListBottom(playList) { //混入，当播放列表有值时增加底部的padding\r\n            const bottom = playList.length > 0 ? '1.2rem' : 0;\r\n            this.$refs.scroll.$el.style.bottom = bottom;\r\n            this.$refs.scroll.refresh();\r\n        },\r\n        randomPlay() {  //随机播放全部\r\n            this.randomPlayAll(this.songs);\r\n        },\r\n        ...mapActions([\r\n            'selectMusic',\r\n            'randomPlayAll'\r\n        ])\r\n    },\r\n    watch: {\r\n        scrollY(newY) {\r\n            const maxLayerH = Math.max(this.MaxLayerHeight,newY); //获取遮罩层的位移\r\n            this.$refs.layer.style[transform] = `translate3d(0,${maxLayerH}px,0)`;\r\n\r\n            if(newY <= this.MaxLayerHeight){  //图层高度缩小，层级高于layer，低于header\r\n                this.$refs.bgImage.style.paddingTop = 0;\r\n                this.$refs.bgImage.style.height = 0.88 + 'rem';\r\n                this.$refs.bgImage.style.zIndex = 9;  \r\n                this.$refs.playBtn.style.display = 'none';\r\n            } else {\r\n                this.$refs.bgImage.style.paddingTop = 70 + '%';\r\n                this.$refs.bgImage.style.height =0;\r\n                this.$refs.bgImage.style.zIndex = 0;  \r\n                this.$refs.playBtn.style.display = 'block';\r\n            }\r\n            \r\n            if(newY > 0) {\r\n                let scaleNum = 1 + Math.abs(newY / this.$refs.bgImage.clientHeight);\r\n                this.$refs.bgImage.style[transform] = `scale(${scaleNum})`\r\n            }\r\n        }\r\n    },\r\n    computed: {\r\n        bgImg() {\r\n            return `background-image:url('${this.bgImage}')`;\r\n        }\r\n    },\r\n    components: {\r\n        'v-songList': SongList,\r\n        'v-scroll': Scroll,\r\n        'v-loading': Loading\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"stylus\" scoped>\r\n@import '~styles/variable';\r\n@import '~styles/mixin';\r\n\r\n.detail\r\n    absolute()\r\n    .detail-header\r\n        position: absolute\r\n        top: 0\r\n        width: 100%\r\n        height: .88rem\r\n        z-index:10\r\n        .iconfont\r\n            position: absolute\r\n            width: .88rem\r\n            height: .88rem\r\n            line-height: .88rem\r\n            text-align:center\r\n            color: $color-theme\r\n            font-size: $font-size-large-x\r\n        .detail-title\r\n            height: .88rem\r\n            line-height: .88rem\r\n            text-align: center\r\n            font-size: $font-size-large\r\n            color: $color-text\r\n    .detail-bgImg\r\n        position: relative\r\n        top: 0\r\n        width: 100%\r\n        height: 0\r\n        padding-top: 70%\r\n        background-size: 100%\r\n        transform-origin: center 0\r\n        .play-wrapper\r\n            position: absolute\r\n            width: 100%\r\n            bottom: .4rem\r\n            .play\r\n                width: 2.7rem\r\n                margin: 0 auto\r\n                padding: .14rem 0 \r\n                color: $color-theme\r\n                border: .02rem solid $color-theme\r\n                border-radius: 2rem\r\n                flex-center()\r\n                .play-text\r\n                    padding-left: .1rem\r\n                    font-size: $font-size-small\r\n        .filter\r\n            absolute()\r\n            background: rgba(7,17,27,.4)\r\n    .songList-wrapper\r\n        position: absolute\r\n        bottom: 0\r\n        width: 100%\r\n    .layer\r\n        position: relative\r\n        height: 100%\r\n        background: $color-background\r\n        transform: translate3d(0, 0, 0);\r\n    .loading-wrapper\r\n        position: absolute\r\n        top: 5.26rem\r\n        bottom: 0\r\n        width: 100%\r\n        background: $color-background\r\n</style>\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// src/common/detail/detail.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"detail\"},[_c('div',{staticClass:\"detail-header\"},[_c('i',{staticClass:\"iconfont icon-back\",on:{\"click\":_vm.back}}),_vm._v(\" \"),_c('h1',{staticClass:\"detail-title\"},[_vm._v(_vm._s(_vm.title))])]),_vm._v(\" \"),_c('div',{ref:\"bgImage\",staticClass:\"detail-bgImg\",style:(_vm.bgImg)},[_c('div',{staticClass:\"filter\"}),_vm._v(\" \"),_c('div',{ref:\"playBtn\",staticClass:\"play-wrapper\"},[_c('div',{staticClass:\"play\",on:{\"click\":_vm.randomPlay}},[_c('i',{staticClass:\"iconfont icon-play\"}),_vm._v(\" \"),_c('span',{staticClass:\"play-text\"},[_vm._v(\"随机播放全部\")])])])]),_vm._v(\" \"),_c('div',{ref:\"layer\",staticClass:\"layer\"}),_vm._v(\" \"),_c('v-scroll',{ref:\"scroll\",staticClass:\"songList-wrapper\",attrs:{\"data\":_vm.songs,\"listenScroll\":true,\"probeType\":3},on:{\"scroll\":_vm.scroll}},[_c('v-songList',{attrs:{\"songs\":_vm.songs,\"iconShow\":_vm.iconShow},on:{\"playMusic\":_vm.playMusic}})],1),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.songs.length),expression:\"!songs.length\"}],staticClass:\"loading-wrapper\"},[_c('v-loading')],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-7d14c67d\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/common/detail/detail.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-7d14c67d\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./detail.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./detail.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./detail.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-7d14c67d\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./detail.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-7d14c67d\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/common/detail/detail.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}