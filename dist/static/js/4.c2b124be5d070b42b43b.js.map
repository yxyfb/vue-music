{"version":3,"sources":["webpack:///src/pages/singer/components/singerList.vue","webpack:///./src/pages/singer/components/singerList.vue?481e","webpack:///./src/pages/singer/components/singerList.vue","webpack:///src/pages/singer/singer.vue","webpack:///./src/api/getSinger.js","webpack:///./src/pages/singer/singer.vue?1e5e","webpack:///./src/pages/singer/singer.vue"],"names":["transform","Object","dom","singerList","mixins","mixin","data","curIndex","scrollY","diff","created","this","touch","scrollBarList_height","parseFloat","document","documentElement","style","fontSize","scroll_title_height","groupHeightArr","props","type","Array","default","methods","extends_default","onScrollBarTouchStart","e","barItemIndex","parseInt","target","firstTouch","touches","y1","pageY","initIndex","_scrollToElement","onScrollBarTouchMove","y2","moveIndex","lastIndex","index","$refs","scroll","scrollToElement","listGroup","pos","y","_getGroupHeight","list","h","push","i","length","offsetHeight","goSingerDetail","singer","$router","path","mid","setSinger","changeListBottom","playList","_this","bottom","setTimeout","$el","refresh","vuex_esm","watch","_this2","newY","fixedList","opacity","arr","h1","h2","Math","abs","newDiff","fixedTop","computed","scrollBarData","map","val","title","substr","fixedText","components","v-scroll","scroll_scroll","components_singerList","render","_vm","_h","$createElement","_c","_self","ref","staticClass","attrs","probeType","listenScroll","click","on","_l","key","refInFor","_v","_s","item","$event","directives","name","rawName","value","expression","touchstart","preventDefault","touchmove","stopPropagation","class","curbar","data-index","_e","staticRenderFns","singer_components_singerList","__webpack_require__","normalizeComponent","ssrContext","singer_singer","_getData","assign_default","recommendParams","g_tk","channel","page","pagesize","pagenum","hostUin","needNewCode","platform","Jsonp","param","then","res","code","ERR_OK","Error","catch","err","console","log","_initData","hot","items","forEach","Fsinger_mid","Fsinger_name","Findex","ret","match","sort","a","b","charCodeAt","concat","v-singerList","pages_singer_singer","singer_Component","singer_normalizeComponent","__webpack_exports__"],"mappings":"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","file":"static/js/4.c2b124be5d070b42b43b.js","sourcesContent":["<template>\r\n    <v-scroll class=\"singerList\" v-if='singerList.length>0'\r\n              :probeType='3'\r\n              :listenScroll='true'\r\n              :click='false'\r\n              @scroll='scroll'\r\n              ref='scroll'>\r\n    <!-- scroll插件只作用于第一个元素 -->\r\n        <ul>\r\n            <li class=\"list-group\" v-for='list of singerList'\r\n                :key='list.title'\r\n                ref='listGroup'>\r\n                <h3 class=\"list-group-title\">{{list.title}}</h3>\r\n                <ul>\r\n                    <li class=\"list-group-item\" v-for='item of list.items'\r\n                        :key='item.mid'\r\n                        @click='goSingerDetail(item)'>\r\n                        <img v-lazy=\"item.avatar\" class=\"avatar\">\r\n                        <span class=\"name\">{{item.name}}</span>\r\n                    </li>\r\n                </ul>\r\n            </li>\r\n        </ul>\r\n\r\n        <ul class=\"scroll-bar\" \r\n            v-if='scrollBarData'\r\n            @touchstart.prevent='onScrollBarTouchStart'\r\n            @touchmove.stop.prevent='onScrollBarTouchMove'>\r\n            <li class=\"bar-item\" \r\n                v-for='(title,index) of scrollBarData'\r\n                :key='index'\r\n                :class=\"{'curbar':index === curIndex}\"\r\n                :data-index='index'>{{title}}</li>\r\n        </ul>\r\n\r\n        <div class=\"fixed-list\" ref='fixedList'>\r\n            <h3 class='fixed-title'>{{fixedText}}</h3>\r\n        </div>\r\n\r\n        \r\n    </v-scroll>\r\n</template>\r\n\r\n<script>\r\n/* 大致思路：bar可以控制页面的滚动，页面的滚动获取curIndex,curIndex就可以控制bar的高亮 */\r\n\r\n\r\nimport Scroll from 'common/scroll/scroll'\r\nimport {getDataIndex,prefixStyle} from 'js/dom'\r\nimport {mapMutations} from 'vuex'\r\nimport {playListMixin} from 'js/mixin'\r\n\r\nconst BAR_HEIGHT = 0.36;  //bar每行的高度\r\nconst transform = prefixStyle('transform');//兼容性\r\n\r\nexport default {\r\n    mixins:[playListMixin],\r\n    data() {\r\n        return {\r\n            curIndex: 0,\r\n            scrollY: 0,\r\n            diff: -1   //每个group的下限，与滚动之间的距离\r\n        }\r\n    },\r\n    created(){\r\n        this.touch = {};\r\n        this.scrollBarList_height = BAR_HEIGHT * parseFloat(document.documentElement.style.fontSize);\r\n        this.scroll_title_height =  0.6*parseFloat(document.documentElement.style.fontSize);\r\n        this.groupHeightArr = []; //存放每一组的高度\r\n    },\r\n    props: {\r\n        singerList: {\r\n            type: Array,\r\n            default: []\r\n        }\r\n    },\r\n    methods: {\r\n        onScrollBarTouchStart(e) {\r\n            let barItemIndex = parseInt(getDataIndex(e.target,'index')); //通过事件捕获，获取当前子元素的data-index值\r\n            \r\n            let firstTouch = e.touches[0];\r\n            this.touch.y1 = firstTouch.pageY;  \r\n            this.touch.initIndex = barItemIndex;\r\n           \r\n            this._scrollToElement(barItemIndex);\r\n        },\r\n        onScrollBarTouchMove(e) {\r\n            this.touch.y2 = e.touches[0].pageY;  //移动的位置\r\n            let moveIndex = (this.touch.y2 - this.touch.y1) / this.scrollBarList_height;//移动了几个barList\r\n            let lastIndex = this.touch.initIndex+moveIndex;\r\n            this._scrollToElement(lastIndex);\r\n        },\r\n         _scrollToElement(index) {\r\n            this.$refs.scroll.scrollToElement(this.$refs.listGroup[index],0);\r\n        },\r\n        scroll(pos) {\r\n            this.scrollY = pos.y;\r\n        },\r\n        _getGroupHeight() { //获取每个组的高度\r\n            let list = this.$refs.listGroup;\r\n            let h = 0;\r\n            this.groupHeightArr.push(h);\r\n            for(let i = 0; i < list.length-1; i++){\r\n                h += list[i].offsetHeight;\r\n                this.groupHeightArr.push(h);\r\n            }\r\n        },\r\n        goSingerDetail(singer) {\r\n            this.$router.push({\r\n                path:`/singer/${singer.mid}`\r\n            })\r\n            this.setSinger(singer); //将歌手信息提交到vuex\r\n        },\r\n        changeListBottom(playList) { //混入，当播放列表有值时增加底部的padding\r\n            const bottom = playList.length > 0 ? '1.2rem' : 0;\r\n            setTimeout(() => {\r\n                this.$refs.scroll.$el.style.bottom = bottom;\r\n                this.$refs.scroll.refresh();\r\n            },1000)\r\n        },\r\n        ...mapMutations({\r\n            setSinger:'SET_SINGER'\r\n        })\r\n    },\r\n    watch: {\r\n        singerList() {  //获取到数据，就把高度存入数组\r\n            setTimeout(() => {  //dom加载完毕，再执行\r\n                this._getGroupHeight();\r\n            },20)\r\n        },\r\n        scrollY(newY){  //根据高度计算curIndex\r\n            if(newY > 0) {\r\n                this.$refs.fixedList.style.opacity = 0;\r\n            }else {\r\n                this.$refs.fixedList.style.opacity = 1;\r\n            }\r\n            let arr = this.groupHeightArr;\r\n            for(let i =0; i<arr.length-1; i++) {\r\n                let h1 = arr[i];\r\n                let h2 = arr[i+1];\r\n                if(Math.abs(newY) >= h1 && Math.abs(newY) <h2) { //'大于等于'至关重要,如果没有等于，点击bar跳转，curIndex始终少一位\r\n                    this.curIndex = i;\r\n                    this.diff = h2 + newY; //每个group的下限，与滚动之间的距离：h2是正数，newY是负整数，所以能算出之间的距离\r\n                } else if (Math.abs(newY) > h2){  \r\n                    this.curIndex = i+1;\r\n                    this.$refs.fixedList.style[transform] = `translate3d(0,0,0)`;\r\n                }\r\n            }\r\n        },\r\n        diff(newDiff) {   //原理，滚动距离，与每个group下限        \r\n            let fixedTop = (newDiff>0 && newDiff < this.scroll_title_height) ? newDiff-this.scroll_title_height : 0;\r\n            this.$refs.fixedList.style[transform] = `translate3d(0,${fixedTop}px,0)`;\r\n        }\r\n    },\r\n    computed: {\r\n        scrollBarData() { //滚动条上都是单数\r\n            return this.singerList.map(val => {\r\n                return val.title.substr(0,1);\r\n            })\r\n        },\r\n        fixedText() {\r\n            if(this.scrollY > 0) {\r\n                return '';\r\n            }\r\n            return this.singerList[this.curIndex] ? this.singerList[this.curIndex].title : ''\r\n        }\r\n    },\r\n    components: {\r\n        'v-scroll': Scroll\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"stylus\" scoped>\r\n@import '~styles/variable';\r\n@import '~styles/mixin';\r\n\r\n.singerList\r\n    overflow: hidden\r\n    position: fixed\r\n    width: 100%\r\n    top: 1.76rem\r\n    bottom: 0\r\n    .list-group\r\n        padding-bottom: .4rem\r\n        .list-group-title\r\n            padding-left: .4rem\r\n            height: .6rem\r\n            line-height: .6rem\r\n            color: $color-text-l\r\n            font-size: $font-size-small\r\n            background: $color-highlight-background\r\n        .list-group-item\r\n            font-size: 0\r\n            padding: .4rem .6rem 0\r\n            flex-center()\r\n            .avatar\r\n                width: 1rem\r\n                height: 1rem\r\n                border-radius: 100%\r\n            .name\r\n                flex: 1\r\n                padding-left: .4rem\r\n                font-size: $font-size-medium\r\n                color: $color-text-l\r\n    .scroll-bar\r\n        position: absolute\r\n        top: 50%\r\n        right: 0\r\n        transform:translate3d(0,-50%,0)\r\n        width: .4rem\r\n        padding: .4rem 0\r\n        border-radius: .2rem\r\n        background: $color-background-d\r\n        text-align: center\r\n        color: $color-text-l\r\n        .bar-item\r\n            padding: .04rem 0\r\n            &.curbar\r\n                color: $color-theme\r\n    .fixed-list\r\n        position: absolute\r\n        top: 0\r\n        width: 100%\r\n        .fixed-title\r\n            padding-left: .4rem\r\n            width: 100%\r\n            height: .6rem\r\n            line-height: .6rem\r\n            color: $color-text-l\r\n            font-size: $font-size-small\r\n            background: $color-highlight-background\r\n            box-sizing: border-box\r\n</style>\n\n\n// WEBPACK FOOTER //\n// src/pages/singer/components/singerList.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.singerList.length>0)?_c('v-scroll',{ref:\"scroll\",staticClass:\"singerList\",attrs:{\"probeType\":3,\"listenScroll\":true,\"click\":false},on:{\"scroll\":_vm.scroll}},[_c('ul',_vm._l((_vm.singerList),function(list){return _c('li',{key:list.title,ref:\"listGroup\",refInFor:true,staticClass:\"list-group\"},[_c('h3',{staticClass:\"list-group-title\"},[_vm._v(_vm._s(list.title))]),_vm._v(\" \"),_c('ul',_vm._l((list.items),function(item){return _c('li',{key:item.mid,staticClass:\"list-group-item\",on:{\"click\":function($event){return _vm.goSingerDetail(item)}}},[_c('img',{directives:[{name:\"lazy\",rawName:\"v-lazy\",value:(item.avatar),expression:\"item.avatar\"}],staticClass:\"avatar\"}),_vm._v(\" \"),_c('span',{staticClass:\"name\"},[_vm._v(_vm._s(item.name))])])}),0)])}),0),_vm._v(\" \"),(_vm.scrollBarData)?_c('ul',{staticClass:\"scroll-bar\",on:{\"touchstart\":function($event){$event.preventDefault();return _vm.onScrollBarTouchStart($event)},\"touchmove\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.onScrollBarTouchMove($event)}}},_vm._l((_vm.scrollBarData),function(title,index){return _c('li',{key:index,staticClass:\"bar-item\",class:{'curbar':index === _vm.curIndex},attrs:{\"data-index\":index}},[_vm._v(_vm._s(title))])}),0):_vm._e(),_vm._v(\" \"),_c('div',{ref:\"fixedList\",staticClass:\"fixed-list\"},[_c('h3',{staticClass:\"fixed-title\"},[_vm._v(_vm._s(_vm.fixedText))])])]):_vm._e()}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-11222cf6\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/singer/components/singerList.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-11222cf6\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./singerList.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./singerList.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./singerList.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-11222cf6\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./singerList.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-11222cf6\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/singer/components/singerList.vue\n// module id = null\n// module chunks = ","<template>\r\n    <div class=\"singer\">\r\n        <v-singerList :singerList='singerList'></v-singerList>\r\n\r\n        <router-view></router-view>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport singerList from './components/singerList'\r\nimport {getSinger} from 'api/getSinger'\r\nimport Singer from 'js/singer'   //实例化\r\n\r\nconst HOT_TITLE = '热门';\r\nconst HOT_NUMBER = 10;\r\n\r\nexport default {\r\n    name:'singer',\r\n      data() {\r\n        return {\r\n            singerList:[]\r\n        }\r\n    },\r\n    created() {\r\n        this._getData();\r\n    },\r\n    methods: {\r\n        _getData() { //获取数据\r\n            getSinger().then(res => {\r\n                this.singerList = this._initData(res.list);console.log(this.singerList);\r\n            })\r\n        },\r\n        _initData(data) { //整理数据\r\n            let map = {\r\n                hot:{\r\n                    title: HOT_TITLE,\r\n                    items: []\r\n                }\r\n            };\r\n             //1.先分组\r\n            data.forEach((item,index) => {\r\n                //前10个的热门歌手数据放入\r\n                if(index < HOT_NUMBER) {\r\n                    map.hot.items.push(new Singer({  //这里实例化，是复用，简写的目的\r\n                        mid: item.Fsinger_mid,\r\n                        name: item.Fsinger_name,\r\n                    }))\r\n                }\r\n                //根据每个歌手的Findex值(ABC..)，分组\r\n                const key = item.Findex;\r\n                if(!map[key]) {\r\n                    map[key] = {\r\n                        title: key,\r\n                        items:[]\r\n                    }\r\n                }\r\n                map[key].items.push(new Singer({\r\n                    mid: item.Fsinger_mid,\r\n                    name: item.Fsinger_name,\r\n                }))\r\n            });\r\n            \r\n            //2.在排序\r\n            let hot = [];  //存热门\r\n            let ret = [];  //存A-Z\r\n            for(let key in map) {\r\n                let val = map[key];\r\n                if(val.title.match(/[a-zA-Z]/)) {  //str.match(pattern)  返回布尔值\r\n                    ret.push(val);\r\n                } else if (val.title === HOT_TITLE) {\r\n                    hot.push(val);\r\n                }\r\n            }\r\n            ret.sort((a,b) => {\r\n                return a.title.charCodeAt(a) - b.title.charCodeAt(b) ;  //根据Unicode编码，排序，a-b为升序\r\n            })\r\n\r\n            return hot.concat(ret);\r\n        }\r\n    },\r\n    components: {\r\n        'v-singerList': singerList\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"stylus\" scoped>\r\n@import '~styles/mixin';\r\n\r\n.singer\r\n    overflow: hidden\r\n    absoluteTop()\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/pages/singer/singer.vue","import Jsonp from 'js/jsonp.js';\r\nimport {ERR_OK,recommendParams} from './config.js'\r\n\r\nexport const getSinger = () => {\r\n    const url ='https://c.y.qq.com/v8/fcg-bin/v8.fcg';\r\n    const data = Object.assign({},recommendParams,{\r\n        g_tk: 1928093487,\r\n        channel: 'singer',\r\n        page: 'list',\r\n        key: 'all_all_all',\r\n        pagesize: 100,\r\n        pagenum: 1,\r\n        hostUin: 0,\r\n        needNewCode: 0,\r\n        platform: 'yqq'  \r\n    });\r\n\r\n    return Jsonp(url,data,{\r\n        param: 'jsonpCallback'\r\n    }).then(res => {\r\n        if(res.code === ERR_OK){\r\n            return res.data\r\n        }\r\n        throw new Error('没有获取到数据！');\r\n    }).catch(err => {\r\n        if(err) {\r\n            console.log('歌手列表获取错误' + err);\r\n        }\r\n    })\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/api/getSinger.js","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"singer\"},[_c('v-singerList',{attrs:{\"singerList\":_vm.singerList}}),_vm._v(\" \"),_c('router-view')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-28ac3596\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/singer/singer.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-28ac3596\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./singer.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./singer.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./singer.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-28ac3596\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./singer.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-28ac3596\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/singer/singer.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}